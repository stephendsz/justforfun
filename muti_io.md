# IO多路复用方法对比

| 方法   | 平台支持            | 监控IO数量 |      触发方式      | 执行效率 |
| :----- | :------------------ | :--------: | :----------------: | :------: |
| select | 优秀（全部）        |    1024    |      水平触发      |   一般   |
| poll   | 良好（linux，unix） |   无限制   |      水平触发      |   一般   |
| epoll  | 较差（linux）       |   无限制   | 水平触发和边缘触发 |   较高   |

## select

1. 它可监控的文件描述符数量最多是1024个，
2. 每次进行调用都要将全部描述符从应用进程缓冲区复制到内核缓冲区中，
3. 返回的结果中不会具体声明哪些描述符已经就绪，还需要进行轮询查找

## epoll

1. 没有监控数量限制
2. 只需要将描述符从进程缓冲区向内核缓冲区拷贝一次
3. 不需要轮询查询哪些就绪，epoll返回后直接告诉进程哪些描述符已经就绪

## 水平触发和边缘触发

1.水平触发level trigger LT（状态达到）

　　当被监控的文件描述符上有可读写事件发生时，会通知用户程序去读写，如果用户一次读写没取完数据，他会一直通知用户，如果这个描述符是用户不关心的，它每次都返回通知用户，则会导致用户对于关心的描述符的处理效率降低。

　　**复用型IO中的select和poll都是使用的水平触发方式。**

2.边缘触发edge trigger ET（状态改变）

　　当被监控的文件描述符上有可读写事件发生时，会通知用户程序去读写，它只会通知用户进程一次，这需要用户一次把内容读取完，效率更高。如果用户一次没有读完数据，它不会通知你，也就是它只会通知你一次，直到该文件描述符上出现第二次可读写事件才会通知你，这次返回的内容包括上次未取完的数据。

　　**epoll既支持水平触发也支持边缘触发，默认是水平触发。**

3.比较

　　水平触发是状态达到后，可以多次取数据。这种模式下要注意多次读写的情况下，效率和资源利用率情况。

​        边缘触发是状态改变一次，取一次数据。这种模式下读写数据要注意一次是否能读写完成。

